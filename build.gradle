plugins {
    id 'maven-publish'
    id 'com.enonic.xp.app' version '2.0.0'
    id 'com.jfrog.bintray' version '1.8.4'
}

app {
    name = project.appName
    displayName = 'Azure AD ID Provider'
    vendorName = 'Enonic AS'
    vendorUrl = 'http://enonic.com'
    systemVersion = "${xpVersion}"
}

dependencies {
    compile "com.enonic.xp:core-api:${xpVersion}"
    compile "com.enonic.xp:portal-api:${xpVersion}"
    include "com.enonic.xp:lib-auth:${xpVersion}"
    include "com.enonic.xp:lib-context:${xpVersion}"
    include "com.enonic.xp:lib-io:${xpVersion}"
    include "com.enonic.xp:lib-portal:${xpVersion}"
    include "com.enonic.lib:lib-thymeleaf:2.0.0"
    include 'com.enonic.lib:lib-http-client:2.0.0'
    include 'com.enonic.lib:text-encoding:1.1.0'
    include 'com.enonic.lib:lib-util:2.0.0'
}

repositories {
    mavenLocal()
    mavenCentral()
    jcenter()
    xp.enonicRepo()
}

publishing {
  publications {
    mavenJava(MavenPublication) {
      from components.java
      groupId group
      artifactId projectName
      version version
    }
  }
}

bintray {
	user = System.getenv('BINTRAY_USER')
	key = System.getenv('BINTRAY_KEY')
	publications = ['mavenJava']

	pkg {
		repo = 'public'
		name = 'com.gravitondigital.app.azureadidprovider'
		userOrg = 'gravitondigital'
		licenses = ['MIT']
		vcsUrl = 'https://github.com/GravitonDigital/app-azure-ad-idprovider'
		version {
			name = version
			released  = new Date()
		}
	}
}

//──────────────────────────────────────────────────────────────────────────────
// Generate documentation
//──────────────────────────────────────────────────────────────────────────────
task generate_docs( type: Exec ) {
    executable 'npm'
    args = ['run', 'generate-docs']
    mustRunAfter 'build'
}

